<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iManage Uploader - API Documentation</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
        }
        .container {
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #e74c3c;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        h2 {
            color: #34495e;
            margin-top: 30px;
            margin-bottom: 15px;
            border-left: 4px solid #e74c3c;
            padding-left: 15px;
        }
        h3 {
            color: #7f8c8d;
            margin-top: 25px;
        }
        .method {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 0.8em;
            margin-right: 10px;
        }
        .get { background: #27ae60; color: white; }
        .post { background: #3498db; color: white; }
        .put { background: #f39c12; color: white; }
        .delete { background: #e74c3c; color: white; }
        
        .endpoint {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .endpoint-header {
            font-family: 'Courier New', monospace;
            font-size: 1.1em;
            margin-bottom: 15px;
            padding: 10px;
            background: #2c3e50;
            color: white;
            border-radius: 4px;
        }
        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
        }
        .json-example {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
        }
        .parameter-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        .parameter-table th,
        .parameter-table td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
        }
        .parameter-table th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        .required {
            color: #e74c3c;
            font-weight: bold;
        }
        .optional {
            color: #95a5a6;
        }
        .response-code {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-weight: bold;
        }
        .code-200 { background: #d4edda; color: #155724; }
        .code-400 { background: #f8d7da; color: #721c24; }
        .code-401 { background: #fff3cd; color: #856404; }
        .code-404 { background: #f8d7da; color: #721c24; }
        .code-500 { background: #f8d7da; color: #721c24; }
        
        .schema-section {
            background: #f1f3f4;
            border-left: 4px solid #4285f4;
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }
        .nav-menu {
            background: #34495e;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 30px;
        }
        .nav-menu a {
            color: #ecf0f1;
            text-decoration: none;
            margin-right: 20px;
            padding: 5px 10px;
            border-radius: 4px;
            transition: background 0.3s;
        }
        .nav-menu a:hover {
            background: #2c3e50;
        }
        .warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìö API Documentation</h1>
        <p><strong>Complete API reference for iManage Uploader</strong></p>
        
        <div class="nav-menu">
            <a href="#authentication">Authentication</a>
            <a href="#workspaces">Workspaces</a>
            <a href="#uploads">File Uploads</a>
            <a href="#schemas">Data Schemas</a>
            <a href="#errors">Error Handling</a>
        </div>

        <div class="warning">
            <strong>‚ö†Ô∏è Base URL:</strong> All API endpoints are relative to your server's base URL (e.g., <code>http://localhost:5000</code>)
        </div>

        <h2 id="authentication">üîê Authentication Endpoints</h2>
        
        <div class="endpoint">
            <div class="endpoint-header">
                <span class="method post">POST</span> /api/auth/login
            </div>
            <p><strong>Description:</strong> Authenticate user with iManage credentials</p>
            
            <h4>Request Body:</h4>
            <table class="parameter-table">
                <tr>
                    <th>Parameter</th>
                    <th>Type</th>
                    <th>Required</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>serverUrl</td>
                    <td>string</td>
                    <td class="required">Yes</td>
                    <td>iManage server URL</td>
                </tr>
                <tr>
                    <td>username</td>
                    <td>string</td>
                    <td class="required">Yes</td>
                    <td>User's username</td>
                </tr>
                <tr>
                    <td>password</td>
                    <td>string</td>
                    <td class="required">Yes</td>
                    <td>User's password</td>
                </tr>
            </table>

            <h4>Example Request:</h4>
            <div class="json-example">
{
  "serverUrl": "https://your-imanage-server.com",
  "username": "john.doe",
  "password": "secure_password"
}
            </div>

            <h4>Response:</h4>
            <p><span class="response-code code-200">200 OK</span> - Authentication successful</p>
            <div class="json-example">
{
  "user": {
    "id": "user-123",
    "username": "john.doe",
    "serverUrl": "https://your-imanage-server.com"
  },
  "token": "mock_token_abc123..."
}
            </div>
            
            <p><span class="response-code code-400">400 Bad Request</span> - Invalid credentials or missing fields</p>
        </div>

        <div class="endpoint">
            <div class="endpoint-header">
                <span class="method get">GET</span> /api/auth/me
            </div>
            <p><strong>Description:</strong> Get current authenticated user information</p>
            
            <h4>Headers:</h4>
            <table class="parameter-table">
                <tr>
                    <th>Header</th>
                    <th>Value</th>
                    <th>Required</th>
                </tr>
                <tr>
                    <td>Authorization</td>
                    <td>Bearer {token}</td>
                    <td class="required">Yes</td>
                </tr>
            </table>

            <h4>Response:</h4>
            <p><span class="response-code code-200">200 OK</span> - User information retrieved</p>
            <div class="json-example">
{
  "id": "user-123",
  "username": "john.doe",
  "serverUrl": "https://your-imanage-server.com"
}
            </div>
            
            <p><span class="response-code code-401">401 Unauthorized</span> - Invalid or missing token</p>
        </div>

        <h2 id="workspaces">üìÅ Workspace Endpoints</h2>
        
        <div class="endpoint">
            <div class="endpoint-header">
                <span class="method get">GET</span> /api/workspaces
            </div>
            <p><strong>Description:</strong> Retrieve available workspaces for the authenticated user</p>
            
            <h4>Headers:</h4>
            <table class="parameter-table">
                <tr>
                    <th>Header</th>
                    <th>Value</th>
                    <th>Required</th>
                </tr>
                <tr>
                    <td>Authorization</td>
                    <td>Bearer {token}</td>
                    <td class="required">Yes</td>
                </tr>
            </table>

            <h4>Response:</h4>
            <p><span class="response-code code-200">200 OK</span> - Workspaces retrieved successfully</p>
            <div class="json-example">
[
  {
    "id": "workspace-1",
    "name": "Legal Documents",
    "description": "Legal department workspace",
    "metadataFields": [
      {
        "name": "documentType",
        "label": "Document Type",
        "type": "select",
        "required": true,
        "options": ["Contract", "Agreement", "Policy"]
      }
    ]
  }
]
            </div>
        </div>

        <div class="endpoint">
            <div class="endpoint-header">
                <span class="method get">GET</span> /api/workspaces/{id}/metadata
            </div>
            <p><strong>Description:</strong> Get metadata fields for a specific workspace</p>
            
            <h4>Path Parameters:</h4>
            <table class="parameter-table">
                <tr>
                    <th>Parameter</th>
                    <th>Type</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>id</td>
                    <td>string</td>
                    <td>Workspace ID</td>
                </tr>
            </table>

            <h4>Response:</h4>
            <p><span class="response-code code-200">200 OK</span> - Metadata fields retrieved</p>
            <div class="json-example">
[
  {
    "name": "documentType",
    "label": "Document Type",
    "type": "select",
    "required": true,
    "options": ["Contract", "Agreement", "Policy"]
  },
  {
    "name": "matterNumber",
    "label": "Matter Number",
    "type": "text",
    "required": false
  }
]
            </div>
        </div>

        <h2 id="uploads">üì§ File Upload Endpoints</h2>
        
        <div class="endpoint">
            <div class="endpoint-header">
                <span class="method post">POST</span> /api/upload/session
            </div>
            <p><strong>Description:</strong> Create a new upload session</p>
            
            <h4>Request Body:</h4>
            <table class="parameter-table">
                <tr>
                    <th>Parameter</th>
                    <th>Type</th>
                    <th>Required</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>workspaceId</td>
                    <td>string</td>
                    <td class="required">Yes</td>
                    <td>Target workspace ID</td>
                </tr>
                <tr>
                    <td>totalFiles</td>
                    <td>number</td>
                    <td class="required">Yes</td>
                    <td>Total number of files to upload</td>
                </tr>
                <tr>
                    <td>metadata</td>
                    <td>object</td>
                    <td class="optional">No</td>
                    <td>Document metadata</td>
                </tr>
            </table>

            <h4>Response:</h4>
            <p><span class="response-code code-200">200 OK</span> - Upload session created</p>
            <div class="json-example">
{
  "id": "session-abc123",
  "userId": "user-123",
  "workspaceId": "workspace-1",
  "status": "pending",
  "totalFiles": 5,
  "completedFiles": 0,
  "failedFiles": 0,
  "createdAt": "2024-01-15T10:30:00Z"
}
            </div>
        </div>

        <div class="endpoint">
            <div class="endpoint-header">
                <span class="method post">POST</span> /api/upload/{sessionId}/files
            </div>
            <p><strong>Description:</strong> Upload files to an existing session</p>
            
            <h4>Content-Type:</h4>
            <p><code>multipart/form-data</code></p>
            
            <h4>Form Data:</h4>
            <table class="parameter-table">
                <tr>
                    <th>Field</th>
                    <th>Type</th>
                    <th>Required</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>files</td>
                    <td>File[]</td>
                    <td class="required">Yes</td>
                    <td>Array of files to upload</td>
                </tr>
            </table>

            <h4>Supported File Types:</h4>
            <ul>
                <li>PDF (.pdf)</li>
                <li>Microsoft Word (.doc, .docx)</li>
                <li>Microsoft Excel (.xls, .xlsx)</li>
                <li>Plain Text (.txt)</li>
                <li>CSV (.csv)</li>
            </ul>

            <h4>File Size Limit:</h4>
            <p>Maximum file size: <strong>50MB</strong></p>

            <h4>Response:</h4>
            <p><span class="response-code code-200">200 OK</span> - Upload started</p>
            <div class="json-example">
{
  "message": "Upload started",
  "sessionId": "session-abc123",
  "fileCount": 3
}
            </div>
        </div>

        <div class="endpoint">
            <div class="endpoint-header">
                <span class="method get">GET</span> /api/upload/{sessionId}/progress
            </div>
            <p><strong>Description:</strong> Get upload progress for a session</p>
            
            <h4>Response:</h4>
            <p><span class="response-code code-200">200 OK</span> - Progress information</p>
            <div class="json-example">
{
  "sessionId": "session-abc123",
  "totalFiles": 5,
  "completedFiles": 3,
  "failedFiles": 1,
  "progress": 60,
  "status": "uploading",
  "files": [
    {
      "id": "file-1",
      "fileName": "document1.pdf",
      "status": "completed"
    },
    {
      "id": "file-2",
      "fileName": "document2.docx",
      "status": "failed",
      "errorMessage": "Network timeout"
    }
  ]
}
            </div>
        </div>

        <div class="endpoint">
            <div class="endpoint-header">
                <span class="method post">POST</span> /api/upload/{sessionId}/retry
            </div>
            <p><strong>Description:</strong> Retry failed uploads in a session</p>
            
            <h4>Response:</h4>
            <p><span class="response-code code-200">200 OK</span> - Retry started</p>
            <div class="json-example">
{
  "message": "Retry started"
}
            </div>
        </div>

        <h2 id="schemas">üìã Data Schemas</h2>
        
        <div class="schema-section">
            <h3>User Schema</h3>
            <div class="json-example">
{
  "id": "string",
  "username": "string",
  "serverUrl": "string",
  "accessToken": "string | null",
  "createdAt": "timestamp"
}
            </div>
        </div>

        <div class="schema-section">
            <h3>Workspace Schema</h3>
            <div class="json-example">
{
  "id": "string",
  "name": "string",
  "description": "string | null",
  "userId": "string",
  "metadataFields": [
    {
      "name": "string",
      "label": "string",
      "type": "text | select | textarea",
      "required": "boolean",
      "options": "string[] | undefined"
    }
  ]
}
            </div>
        </div>

        <div class="schema-section">
            <h3>Upload Session Schema</h3>
            <div class="json-example">
{
  "id": "string",
  "userId": "string",
  "workspaceId": "string",
  "status": "pending | uploading | completed | failed",
  "totalFiles": "number",
  "completedFiles": "number",
  "failedFiles": "number",
  "metadata": "object",
  "createdAt": "timestamp"
}
            </div>
        </div>

        <h2 id="errors">‚ö†Ô∏è Error Handling</h2>
        
        <h3>Common Error Responses</h3>
        
        <div class="endpoint">
            <h4><span class="response-code code-400">400 Bad Request</span></h4>
            <div class="json-example">
{
  "message": "Validation error description"
}
            </div>
        </div>

        <div class="endpoint">
            <h4><span class="response-code code-401">401 Unauthorized</span></h4>
            <div class="json-example">
{
  "message": "Authentication required"
}
            </div>
        </div>

        <div class="endpoint">
            <h4><span class="response-code code-404">404 Not Found</span></h4>
            <div class="json-example">
{
  "message": "Resource not found"
}
            </div>
        </div>

        <div class="endpoint">
            <h4><span class="response-code code-500">500 Internal Server Error</span></h4>
            <div class="json-example">
{
  "message": "Internal server error description"
}
            </div>
        </div>

        <h3>File Upload Errors</h3>
        <ul>
            <li><strong>File too large:</strong> Files exceeding 50MB will be rejected</li>
            <li><strong>Unsupported file type:</strong> Only specified file types are allowed</li>
            <li><strong>Network timeout:</strong> Upload may fail due to network issues</li>
            <li><strong>Server error:</strong> iManage server integration errors</li>
        </ul>

        <div class="warning">
            <strong>üí° Best Practices:</strong>
            <ul>
                <li>Always include proper error handling in your client applications</li>
                <li>Implement retry logic for failed uploads</li>
                <li>Monitor upload progress and provide user feedback</li>
                <li>Validate file types and sizes before uploading</li>
            </ul>
        </div>
    </div>
</body>
</html>
